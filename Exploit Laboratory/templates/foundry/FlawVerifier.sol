// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.22;

import {Test, console2} from "forge-std/Test.sol";

interface IOFT {
    function sharedDecimals() external view returns (uint8);
    function decimalConversionRate() external view returns (uint256);
    function endpoint() external view returns (address);
}

contract FlawVerifier {
    address constant OWL = 0x51E667E91b4B8Cb8e6E0528757F248406bD34B57;

    constructor() payable {}

    function executeOnOpportunity() public {
        uint8 sd = IOFT(OWL).sharedDecimals();
        uint256 dcr = IOFT(OWL).decimalConversionRate();
        address ep = IOFT(OWL).endpoint();

        console2.log("--- OWL Probe ---");
        console2.log("Shared Decimals:", sd);
        console2.log("Conversion Rate:", dcr);
        console2.log("LZ Endpoint:", ep);

        // Try a fake lzReceive (should fail due to onlyEndpoint)
        (bool success, bytes memory data) = OWL.call(
            abi.encodeWithSignature("lzReceive(uint32,bytes32,uint64,address,bytes)", 
            101, bytes32(0), 1, ep, "")
        );
        console2.log("Direct lzReceive success (expected false):", success);
    }
}
